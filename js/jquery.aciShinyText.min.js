
/*
 * aciShinyText jQuery Plugin v1.0
 * http://acoderinsights.ro
 *
 * Copyright (c) 2013 Dragos Ursu
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Require jQuery Library http://jquery.com
 * Based on the ideea behind http://labs.dragoninteractive.com/rainbows_demo.php
 *
 * Date: Fri Jan 25 22:15 2013 +0200
 */

(function(a){a.aciShinyText={nameSpace:".aciShinyText"};a.fn.aciShinyText=function(c,e){var b=null;for(var d=0;d<this.length;d++){b=a(this[d])._aciShinyText(c,e);if(!(b instanceof jQuery)){return b}}return this};a.fn.aciShinyText.defaults={colors:["#ccc","#000"],highlight:false,shadow:false,ratio:1,exclude:"script",autoInit:true,callbacks:{beforeInit:null,afterInit:null}};a.fn._aciShinyText=function(s,n){var l=this;var r=function(i){if(typeof i=="string"){i=i.replace(/[^0-9a-f]/i,"");switch(i.length){case 3:return{r:parseInt(i.substr(0,1)+i.substr(0,1),16),g:parseInt(i.substr(1,1)+i.substr(1,1),16),b:parseInt(i.substr(2,1)+i.substr(2,1),16)};case 6:return{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16)}}}return{r:0,g:0,b:0}};var e=this.data(a.aciShinyText.nameSpace);if(!e&&((typeof s=="undefined")||(typeof s=="object"))){e={options:a.extend({},a.fn.aciShinyText.defaults,s),wasInit:false,colors:[]};for(var f in e.options.colors){e.colors[f]=r(e.options.colors[f])}this.data(a.aciShinyText.nameSpace,e)}var q=function(A,C,z){var y=[];var v=A.length;var x,w,B=-1;for(var u=0,t=0;u<C;u++,t++){w=Math.min(Math.floor(u*(v-1)/C),v-2);if(B!=w){B=w;t=0}x=(t*(v-1)/C)*z;y[y.length]={r:Math.round(A[w].r*(1-x)+A[w+1].r*x),g:Math.round(A[w].g*(1-x)+A[w+1].g*x),b:Math.round(A[w].b*(1-x)+A[w+1].b*x)}}return y};var c=[];var m=function(v){for(var u in c){if(c[u].size==v){return c[u].blend}}var t=q(e.colors,v,e.options.ratio);c[c.length]={size:v,blend:t};return t};var b=function(w,v){var x="";var t=m(v);for(var u in t){x+='<span class="shinyTextLine" style="color:rgb('+t[u].r+","+t[u].g+","+t[u].b+')"><span class="shinyTextItem" style="top:-'+u+'px">'+w+"</span></span>"}return x};var d=function(v){var w=v.text();w=w.replace(/\s+/gm," ");if(w.length&&(w!=" ")){var u="";w=w.split(" ");for(var t in w){u+='<span class="shinyText"><span class="shinyTextOld">'+w[t]+"</span></span>"+((t<w.length-1)?" ":"")}v.replaceWith(u)}};var h=function(t){if(t){if(t===true){return""}else{var i=r(t);return"color:rgb("+i.r+","+i.g+","+i.b+")"}}else{return"display:none"}};var k=function(){if(!e||e.wasInit){return}e.wasInit=true;if(e.options.callbacks&&e.options.callbacks.beforeInit){e.options.callbacks.beforeInit(l)}l.contents().each(function(){if(typeof this.tagName=="undefined"){d(a(this))}});l.find("*").not("[class^=shinyText],"+e.options.exclude).each(function(){a(this).contents().each(function(){if(typeof this.tagName=="undefined"){d(a(this))}})});c=[];var i=h(e.options.highlight);var t=h(e.options.shadow);l.find(".shinyText").each(function(){var v=a(this).find(">.shinyTextOld");var x=v.text();var u=v.height();var w=v.width();v.before('<span class="shinyTextHighlight" style="'+i+'">'+x+'</span><span class="shinyTextShadow" style="'+t+'">'+x+"</span>"+b(x,u));a(this).find("span").not(".shinyTextOld").css({width:w+"px","-moz-user-select":"none","-webkit-user-select":"none"}).attr("unselectable","on").bind("selectstart",function(){return false}).not(".shinyTextHighlight,.shinyTextShadow").css("display","block")});if(e.options.callbacks&&e.options.callbacks.afterInit){e.options.callbacks.afterInit(l)}};var p=function(i){if(!e||!e.wasInit){return}e.options.ratio=i;c=[];l.find(".shinyText").each(function(){var u=a(this).find(".shinyTextLine");var t=m(u.length);for(var v in t){u.eq(v).css("color","rgb("+t[v].r+","+t[v].g+","+t[v].b+")")}})};var o=function(){if((typeof s=="undefined")||(typeof s=="object")){j()}else{if(typeof s=="string"){switch(s){case"init":k();break;case"ratio":p(n);break;case"options":return e?e.options:null;case"destroy":g();break}}}return l};var g=function(){if(e){l.find(".shinyText").each(function(){a(this).find("[class^=shinyText]").not(".shinyTextOld").remove();var i=a(this).find(">.shinyTextOld").text();a(this).replaceWith(i.replace(/&nbsp;$/i," "))});l.data(a.aciShinyText.nameSpace,null)}};var j=function(){if(e.options.autoInit){k()}};return o()}})(jQuery);
